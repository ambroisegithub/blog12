{"version":3,"file":"user.js","names":["signToken","id","jwt","sign","process","env","JWT_SECRET","expiresIn","signup","req","res","userModel","create","body","user","token","_id","status","json","error","message","login","email","password","findOne","select","correctPassword","getAllUsers","find","allUsers","data","users"],"sources":["../../../src/controllers/user.js"],"sourcesContent":["\n\nimport jwt from \"jsonwebtoken\";\nimport userModel from \"../models/user\";\n\nconst signToken = (id) => {\n  return jwt.sign({ id: id }, process.env.JWT_SECRET, {\n    expiresIn: \"4h\",\n  });\n};\nexport const signup = async (req, res) => {\n  try {\n    const user = await userModel.create(req.body);\n\n    const token = signToken(user._id);\n\n    res.status(201).json({\n      status: \"success\",\n      token: token,\n      user,\n    });\n  } catch (err) {\n    res.status(400).json({\n      status: \"failed\",\n      error: err.message,\n    });\n  }\n};\nexport const login = async (req, res) => {\n  const { email, password } = req.body;\n\n  if (!email || !password) {\n    return res.status(400).json({\n      status: \"failed\",\n      message: \"please provide email and password\",\n    });\n  }\n\n  const user = await userModel.findOne({ email }).select(\"+password\");\n  if (!user || !(await user.correctPassword(password, user.password))) {\n    return res.status(401).json({\n      status: \"failed\",\n      message: \"incorrect email or password\",\n    });\n  }\n\n  const token = signToken(user._id);\n\n  res.status(200).json({\n    status: \"success\",\n    token,\n    user,\n  });\n};\n\nexport const getAllUsers = async (req, res) => {\n  try {\n    const allUsers = await userModel.find();\n\n    res.status(200).json({\n      status: \"success\",\n      data: {\n        users: allUsers,\n      },\n    });\n  } catch (error) {\n    res.status(400).json({\n      status: \"failed\",\n      error: error.message,\n    });\n  }\n};\n"],"mappings":"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"}